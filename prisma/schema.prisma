generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model axis {
  id                   Int             @id
  conference_id        Int
  organizer_profile_id Int
  is_voting            Boolean?        @default(false)
  title                String          @db.VarChar
  conferences          conferences     @relation(fields: [conference_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profile              profile         @relation(fields: [organizer_profile_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  presentations        presentations[]
}

model circular {
  id            Int         @id @default(autoincrement())
  conference_id Int
  title         String      @db.VarChar
  info          String      @db.VarChar
  created_at    DateTime?   @default(now()) @db.Timestamp(6)
  conferences   conferences @relation(fields: [conference_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model conferences {
  id                      Int            @id @default(autoincrement())
  active                  Boolean        @default(true)
  title                   String         @db.VarChar
  date                    DateTime       @db.Timestamp(6)
  presentation_limit_date DateTime       @db.Timestamp(6)
  logo_url                String         @db.VarChar
  created_at              DateTime?      @default(now()) @db.Timestamp(6)
  axis                    axis[]
  circular                circular[]
  profile                 profile[]
  sponsors                sponsors[]
  winner_types            winner_types[]
}

model presentations {
  id                                                  Int       @id @default(autoincrement())
  presenter_profile_id                                Int
  evaluator_profile_id                                Int
  axis_id                                             Int
  comments                                            String?   @db.VarChar
  state                                               String    @default("pending") @db.VarChar
  created_at                                          DateTime? @default(now()) @db.Timestamp(6)
  axis                                                axis      @relation(fields: [axis_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profile_presentations_evaluator_profile_idToprofile profile   @relation("presentations_evaluator_profile_idToprofile", fields: [evaluator_profile_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profile_presentations_presenter_profile_idToprofile profile   @relation("presentations_presenter_profile_idToprofile", fields: [presenter_profile_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  votes                                               votes[]
  winners                                             winners[]
}

model profile {
  id                                                        Int             @id @default(autoincrement())
  user_id                                                   Int
  conference_id                                             Int
  attendance_date                                           DateTime?       @db.Timestamp(6)
  created_at                                                DateTime?       @default(now()) @db.Timestamp(6)
  axis                                                      axis[]
  presentations_presentations_evaluator_profile_idToprofile presentations[] @relation("presentations_evaluator_profile_idToprofile")
  presentations_presentations_presenter_profile_idToprofile presentations[] @relation("presentations_presenter_profile_idToprofile")
  conferences                                               conferences     @relation(fields: [conference_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users                                                     users           @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profile_roles                                             profile_roles[]
  votes                                                     votes[]
}

model profile_roles {
  profile_id Int
  roles_id   Int
  profile    profile @relation(fields: [profile_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  roles      roles   @relation(fields: [roles_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@id([profile_id, roles_id])
}

model roles {
  id                 Int                  @id @default(autoincrement())
  role               String               @db.VarChar
  profile_roles      profile_roles[]
  roles_winner_types roles_winner_types[]
}

model roles_winner_types {
  roles_id        Int
  winner_types_id Int
  roles           roles        @relation(fields: [roles_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  winner_types    winner_types @relation(fields: [winner_types_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@id([roles_id, winner_types_id])
}

model sponsors {
  id            Int         @id @default(autoincrement())
  conference_id Int
  image_url     String      @db.VarChar
  link_site     String      @db.VarChar
  conferences   conferences @relation(fields: [conference_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model users {
  id         Int       @id @default(autoincrement())
  email      String    @db.VarChar
  name       String    @db.VarChar
  lastname   String    @db.VarChar
  phone      String    @db.VarChar
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  password   String    @db.VarChar
  profile    profile[]

  @@unique([email])
}

model votes {
  id               Int           @id @default(autoincrement())
  giver_profile_id Int
  presentation_id  Int
  created_at       DateTime?     @default(now()) @db.Timestamp(6)
  profile          profile       @relation(fields: [giver_profile_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  presentations    presentations @relation(fields: [presentation_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model winner_types {
  id                 Int                  @id @default(autoincrement())
  conference_id      Int
  title              String               @db.VarChar
  roles_winner_types roles_winner_types[]
  conferences        conferences          @relation(fields: [conference_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  winners            winners[]
}

model winners {
  id              Int           @id @default(autoincrement())
  presentation_id Int
  winner_type_id  Int
  presentations   presentations @relation(fields: [presentation_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  winner_types    winner_types  @relation(fields: [winner_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}
